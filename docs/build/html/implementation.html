<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="How to Cite" href="cite.html"><link rel="prev" title="pyhazard.utils.metrics" href="_autosummary/utils/pyhazard.utils.metrics.html">
        <link rel="canonical" href="https://labrai.github.io/PyHazard/implementation.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Implementation - PyHazard 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyHazard 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">PyHazard 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyhazard_datasets.html">Datasets</a><input aria-label="Toggle navigation of Datasets" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.Cora.html">pyhazard.datasets.Cora</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.CiteSeer.html">pyhazard.datasets.CiteSeer</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.PubMed.html">pyhazard.datasets.PubMed</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.Computers.html">pyhazard.datasets.Computers</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.Photo.html">pyhazard.datasets.Photo</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.CoauthorCS.html">pyhazard.datasets.CoauthorCS</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/datasets/pyhazard.datasets.CoauthorPhysics.html">pyhazard.datasets.CoauthorPhysics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pyhazard_utils.html">Utils</a><input aria-label="Toggle navigation of Utils" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/utils/pyhazard.utils.hardware.html">pyhazard.utils.hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/utils/pyhazard.utils.dglTopyg.html">pyhazard.utils.dglTopyg</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/utils/pyhazard.utils.metrics.html">pyhazard.utils.metrics</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cite.html">How to Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="team.html">Core Team</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/implementation.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Link to this heading">¶</a></h1>
<p>PyHazard is built to be modular and extensible, allowing contributors to implement their own attack and defense strategies.
Below, we detail how to extend the framework by implementing custom attack and defense classes, with a focus on how to
leverage the provided dataset structure.</p>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> class standardizes the data format across PyHazard. Here’s its structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Dataset</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_type</span><span class="o">=</span><span class="s1">&#39;dgl&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">api_type</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;dgl&#39;</span><span class="p">,</span> <span class="s1">&#39;pyg&#39;</span><span class="p">},</span> <span class="s1">&#39;API type must be dgl or pyg&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_type</span> <span class="o">=</span> <span class="n">api_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>

        <span class="c1"># DGLGraph or PyGData</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_dataset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># meta data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p><strong>Importance</strong>: We are currently using the default <code class="docutils literal notranslate"><span class="pre">api_type='pyg'</span></code> to load the data. It is important to note that when
<code class="docutils literal notranslate"><span class="pre">api_type='pyg'</span></code>, <code class="docutils literal notranslate"><span class="pre">self.graph_data</span></code> should be an instance of <code class="docutils literal notranslate"><span class="pre">torch_geometric.data.Data</span></code>. In your implementation, make
sure to use our defined Dataset class to build your code.</p>
</section>
<section id="device">
<h2>Device<a class="headerlink" href="#device" title="Link to this heading">¶</a></h2>
<p>To ensure consistency and simplicity when managing CUDA devices across attacks and defenses, we follow the convention
below:</p>
<ul class="simple">
<li><p>Both <code class="docutils literal notranslate"><span class="pre">BaseAttack</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseDefense</span></code> define the device attribute <code class="docutils literal notranslate"><span class="pre">self.device</span></code> in their <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method.</p></li>
<li><p>Subclasses should not manually redefine or modify the device logic.</p></li>
<li><p>If you are implementing a custom attack or defense class, simply inherit from <code class="docutils literal notranslate"><span class="pre">BaseAttack</span></code> or <code class="docutils literal notranslate"><span class="pre">BaseDefense</span></code>.</p></li>
<li><p>You can directly access the device using: <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">x.to(self.device)</span></code></p></li>
</ul>
</section>
<section id="implementing-attack">
<h2>Implementing Attack<a class="headerlink" href="#implementing-attack" title="Link to this heading">¶</a></h2>
<p>To create a custom attack, you need to extend the abstract base class <code class="docutils literal notranslate"><span class="pre">BaseAttack</span></code>. Here’s the structure
of <code class="docutils literal notranslate"><span class="pre">BaseAttack</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseAttack</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="n">supported_api_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">supported_datasets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">attack_node_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">if</span> <span class="n">device</span> <span class="k">else</span> <span class="n">get_device</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using device: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># graph data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph_data</span>

        <span class="c1"># meta data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_classes</span>

        <span class="c1"># params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_node_fraction</span> <span class="o">=</span> <span class="n">attack_node_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_path</span> <span class="o">=</span> <span class="n">model_path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_dataset_compatibility</span><span class="p">()</span>
</pre></div>
</div>
<p>To implement your own attack:</p>
<ol class="arabic">
<li><p><strong>Inherit from ``BaseAttack``</strong>:
Create a new class that inherits from <code class="docutils literal notranslate"><span class="pre">BaseAttack</span></code>. You’ll need to provide the following required parameters in the
constructor:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataset</span></code>: An instance of the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> class (see below for details).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attack_node_fraction</span></code>: A float between 0 and 1 representing the fraction of nodes to attack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model_path</span></code> (optional): A string specifying the path to a pre-trained model (defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
<p>You need to implement the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">attack()</span></code>: Add main attack logic here. If multiple attack types are supported, define the attack type as an optional
argument to this function. For each specific attack type, implement a corresponding helper function such as
<code class="docutils literal notranslate"><span class="pre">_attack_type1()</span></code> or <code class="docutils literal notranslate"><span class="pre">_attack_type2()</span></code>, and call the appropriate helper inside <code class="docutils literal notranslate"><span class="pre">attack()</span></code> based on the given method name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_load_model()</span></code>: Load victim model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_train_target_model()</span></code>: Train victim model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_train_attack_model()</span></code>: Train attack model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_helper_func()</span></code> (optional): Add your helper functions based on your needs, but keep the methods private.</p></li>
</ul>
</li>
<li><p><strong>Implement the ``attack()`` Method</strong>:
Override the abstract <code class="docutils literal notranslate"><span class="pre">attack()</span></code> method with your attack logic, and return a dict of results. For example:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomAttack</span><span class="p">(</span><span class="n">BaseAttack</span><span class="p">):</span>
    <span class="n">supported_api_types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pyg&quot;</span><span class="p">}</span>  <span class="c1"># &quot;pyg&quot; or &quot;dgl&quot;</span>
    <span class="n">supported_datasets</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Cora&quot;</span><span class="p">}</span>  <span class="c1"># you can leave this blank if your method supports all datasets</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">attack_node_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">attack_node_fraction</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span>
        <span class="c1"># Additional initialization if needed</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">attack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Example: Access the graph and perform an attack</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attacking </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_node_fraction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">}</span><span class="s2">% of nodes&quot;</span><span class="p">)</span>
        <span class="n">num_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graph has </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span><span class="s2"> nodes&quot;</span><span class="p">)</span>
        <span class="c1"># Add your attack logic here</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;metric1&#39;</span><span class="p">:</span> <span class="s1">&#39;metric1 here&#39;</span><span class="p">,</span>
            <span class="s1">&#39;metric2&#39;</span><span class="p">:</span> <span class="s1">&#39;metric2 here&#39;</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_train_target_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_train_attack_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="implementing-defense">
<h2>Implementing Defense<a class="headerlink" href="#implementing-defense" title="Link to this heading">¶</a></h2>
<p>To create a custom defense, you need to extend the abstract base class <code class="docutils literal notranslate"><span class="pre">BaseDefense</span></code>. Here’s the structure
of <code class="docutils literal notranslate"><span class="pre">BaseDefense</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseDefense</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="n">supported_api_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">supported_datasets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">attack_node_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                 <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">if</span> <span class="n">device</span> <span class="k">else</span> <span class="n">get_device</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using device: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># graph data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph_data</span>

        <span class="c1"># meta data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">num_classes</span>

        <span class="c1"># params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_node_fraction</span> <span class="o">=</span> <span class="n">attack_node_fraction</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_dataset_compatibility</span><span class="p">()</span>
</pre></div>
</div>
<p>To implement your own defense:</p>
<ol class="arabic">
<li><p><strong>Inherit from ``BaseDefense``</strong>:
Create a new class that inherits from <code class="docutils literal notranslate"><span class="pre">BaseDefense</span></code>. You’ll need to provide the following required parameters in the
constructor:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataset</span></code>: An instance of the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> class (see below for details).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attack_node_fraction</span></code>: A float between 0 and 1 representing the fraction of nodes to attack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model_path</span></code> (optional): A string specifying the path to a pre-trained model (defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
<p>You need to implement the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">defense()</span></code>: Add main defense logic here. If multiple defense types are supported, define the defense type as an
optional argument to this function. For each specific defense type, implement a corresponding helper function such as
<code class="docutils literal notranslate"><span class="pre">_defense_type1()</span></code> or <code class="docutils literal notranslate"><span class="pre">_defense_type2()</span></code>, and call the appropriate helper inside <code class="docutils literal notranslate"><span class="pre">defense()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_load_model()</span></code>: Load victim model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_train_target_model()</span></code>: Train victim model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_train_defense_model()</span></code>: Train defense model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_train_surrogate_model()</span></code>: Train attack model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_helper_func()</span></code> (optional): Add your helper functions based on your needs, but keep the methods private.</p></li>
</ul>
</li>
<li><p><strong>Implement the ``defense()`` Method</strong>:
Override the abstract <code class="docutils literal notranslate"><span class="pre">defense()</span></code> method with your defense logic, and return a dict of results. For example:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomDefense</span><span class="p">(</span><span class="n">BaseDefense</span><span class="p">):</span>
    <span class="n">supported_api_types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pyg&quot;</span><span class="p">}</span>  <span class="c1"># &quot;pyg&quot; or &quot;dgl&quot;</span>
    <span class="n">supported_datasets</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Cora&quot;</span><span class="p">}</span>  <span class="c1"># you can leave this blank if your method supports all datasets</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">defend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Step 1: Train target model</span>
        <span class="n">target_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_target_model</span><span class="p">()</span>
        <span class="c1"># Step 2: Attack target model</span>
        <span class="n">attack</span> <span class="o">=</span> <span class="n">MyCustomAttack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">attack_node_fraction</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">attack</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">target_model</span><span class="p">)</span>
        <span class="c1"># Step 3: Train defense model</span>
        <span class="n">defense_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_defense_model</span><span class="p">()</span>
        <span class="c1"># Step 4: Test defense against attack</span>
        <span class="n">attack</span> <span class="o">=</span> <span class="n">MyCustomAttack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">attack_node_fraction</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">attack</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">defense_model</span><span class="p">)</span>
        <span class="c1"># Print performance metrics</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_train_target_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_train_defense_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_train_surrogate_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># add your logic here</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="miscellaneous-tips">
<h2>Miscellaneous Tips<a class="headerlink" href="#miscellaneous-tips" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>Reference Implementation</strong>: The <code class="docutils literal notranslate"><span class="pre">ModelExtractionAttack0</span></code> class is a fully implemented attack example. Study it for
inspiration or as a template.</p></li>
<li><p><strong>Flexibility</strong>: Add as many helper functions as needed within your class to keep your code clean and modular.</p></li>
<li><p><strong>Backbone Models</strong>: We provide several basic backbone models like <code class="docutils literal notranslate"><span class="pre">GCN,</span> <span class="pre">GraphSAGE</span></code>. You can use or add more
at <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">models.nn</span> <span class="pre">import</span> <span class="pre">GraphSAGE</span></code>.</p></li>
<li><p><strong>Example Scripts</strong>: Please provide an example script in the <code class="docutils literal notranslate"><span class="pre">examples/</span></code> folder demonstrating how to run your code. This
will significantly speed up our code review process.</p></li>
</ul>
<p>By following these guidelines, you can seamlessly integrate your custom attack or defense strategies into PyHazard. Happy
coding!</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cite.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How to Cite</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="_autosummary/utils/pyhazard.utils.metrics.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">pyhazard.utils.metrics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, RAILab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Implementation</a><ul>
<li><a class="reference internal" href="#dataset">Dataset</a></li>
<li><a class="reference internal" href="#device">Device</a></li>
<li><a class="reference internal" href="#implementing-attack">Implementing Attack</a></li>
<li><a class="reference internal" href="#implementing-defense">Implementing Defense</a></li>
<li><a class="reference internal" href="#miscellaneous-tips">Miscellaneous Tips</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=4ebf8126"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>